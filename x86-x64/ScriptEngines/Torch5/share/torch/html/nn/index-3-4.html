<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>

 MarginCriterion
</title>
<link href="doctorch.css" rel="stylesheet" type="text/css">
</head>

<body class="torchdoc">
<div id="container">

<div id="header">
<h3>
 MarginCriterion</h3>
</div>

<div id="navline">
<a href="../index.html">Torch Manual</a>&nbsp; > &nbsp; <a href="index.html">
Neural Network Package</a>&nbsp; > &nbsp; <a href="index-3.html">
 Criterions</a>&nbsp; > &nbsp; <b>
 <code>MarginCriterion</code></b>
</div>

<div id="contents">
<a name="MarginCriterion"></a>

<p>

<p>

<pre>
criterion = MarginCriterion()
</pre>
<p>

Creates a criterion that optimizes a two-class classification hinge loss (margin-based loss) between input <code>x</code>  (a Tensor of dimension 1) and output <code>y</code> (which is a scalar, either 1 or -1) :
<p>

<pre>
loss(x,y) = forward(x,y) = max(0,m- y x).
</pre>
<p>

<code>m</code> is the margin, which is by default 1.
<p>

<pre>
criterion = MarginCriterion(marginValue)
</pre>
<p>

sets a different value of <code>m</code>.
<p>

<p>

Example:
<pre>
require "nn"
require "lab"

function gradUpdate(mlp, x, y, criterion, learningRate)
  local pred = mlp:forward(x)
  local err = criterion:forward(pred, y)
  local gradCriterion = criterion:backward(pred, y)
  mlp:zeroGradParameters()
  mlp:backward(x, gradCriterion)
  mlp:updateParameters(learningRate)
end

mlp=nn.Sequential()
mlp:add(nn.Linear(5,1))

x1=lab.rand(5)
x2=lab.rand(5)
criterion=nn.MarginCriterion(1)

for i=1,1000 do
    gradUpdate(mlp,x1,1,criterion,0.01)
    gradUpdate(mlp,x2,-1,criterion,0.01)
end

print(mlp:forward(x1))
print(mlp:forward(x2))

print(criterion:forward(mlp:forward(x1),1))
print(criterion:forward(mlp:forward(x2),-1))
</pre>
gives the output:
<pre>
 1.0043
[torch.Tensor of dimension 1]


-1.0061
[torch.Tensor of dimension 1]

0
0
</pre>
i.e. the mlp successfully separates the two data points such that they both have a margin of 1, and hence a loss of 0.
<p>

</div>



<div id="footer-left">&nbsp;<a href="index-3-3.html">
 <code>ClassNLLCriterion</code></a></div>
<div id="footer-right"><a href="index-3-5.html">
 <code>MSECriterion</code></a>&nbsp;</div>

<div id="last-modified">

</div>

</div>
</body>
</html>
