<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>

  Function Calls
</title>
<link href="doctorch.css" rel="stylesheet" type="text/css">
</head>

<body class="torchdoc">
<div id="container">

<div id="header">
<h3>
  Function Calls</h3>
</div>

<div id="navline">
<a href="index.html">Torch Manual</a>&nbsp; > &nbsp; <a href="LuaManual.html">
Lua 5.1 Reference Manual</a>&nbsp; > &nbsp; <a href="LuaManual-2.html">
  The Language</a>&nbsp; > &nbsp; <a href="LuaManual-2-5.html">
  Expressions</a>&nbsp; > &nbsp; <b>
  Function Calls</b>
</div>

<div id="contents">
<a name="FunctionCalls"></a>

<p>

<p>

<p>

 A function call in Lua has the following syntax:
<pre>
	functioncall ::= prefixexp args
</pre>
<p>

<p>

 In a function call, first prefixexp and args are evaluated. If the value of prefixexp has type <i>function</i>, then this function is called with the given arguments. Otherwise, the prefixexp "call" metamethod is called, having as first parameter the value of prefixexp, followed by the original call arguments (see <a href="LuaManual-2-8.html#Metatables">Metatables</a>).   
<p>

 The form
<pre>
	functioncall ::= prefixexp `*:*` Name args
</pre>
<p>

<p>

 can be used to call "methods". A call <code>v:name(<i>args</i>)</code> is syntactic sugar for <code>v.name(v,<i>args</i>)</code>, except that <code>v</code> is evaluated only once.   
<p>

 Arguments have the following syntax:
<pre>
	args ::= `*(*` [explist1] `*)*`
	args ::= tableconstructor
	args ::= String
</pre>
<p>

<p>

 All argument expressions are evaluated before the call. A call of the form <code>f{_fields_}</code> is syntactic sugar for <code>f({_fields_})</code>; that is, the argument list is a single new table. A call of the form <code>f'_string_'</code> (or <code>f"_string_"</code> or <code>f[[<i>string</i>]]</code>) is syntactic sugar for <code>f('_string_')</code>; that is, the argument list is a single literal string.   
<p>

 As an exception to the free-format syntax of Lua, you cannot put a line break before the '=(=' in a function call. This restriction avoids some ambiguities in the language. If you write
<pre>
     a = f
     (g).x(a)
</pre>
<p>

<p>

 Lua would see that as a single statement, <code>a = f(g).x(a)</code>. So, if you want two statements, you must add a semi-colon between them. If you actually want to call <code>f</code>, you must remove the line break before <code>(g)</code>.   
<p>

 A call of the form <code>return</code> <i>functioncall</i> is called a <i>tail call</i>. Lua implements <i>proper tail calls</i> (or <i>proper tail recursion</i>): in a tail call, the called function reuses the stack entry of the calling function. Therefore, there is no limit on the number of nested tail calls that a program can execute. However, a tail call erases any debug information about the calling function. Note that a tail call only happens with a particular syntax, where the <b>return</b> has one single function call as argument; this syntax makes the calling function return exactly the returns of the called function. So, none of the following examples are tail calls:
<pre>
     return (f(x))        -- results adjusted to 1
     return 2 * f(x)
     return x, f(x)       -- additional results
     f(x); return         -- results discarded
     return x or f(x)     -- results adjusted to 1
</pre>
<p>

</div>



<div id="footer-left">&nbsp;<a href="LuaManual-2-5-7.html">
  Table Constructors</a></div>
<div id="footer-right"><a href="LuaManual-2-5-9.html">
  Function Definitions</a>&nbsp;</div>

<div id="last-modified">

</div>

</div>
</body>
</html>
